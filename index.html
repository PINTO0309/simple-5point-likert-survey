<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5æ®µéšãƒªãƒƒã‚«ãƒ¼ãƒˆå½¢å¼ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        .survey-container {
            display: inline-block;
        }
        .emoji {
            font-size: 50px;
            cursor: pointer;
            padding: 10px;
            transition: transform 0.2s;
        }
        .emoji:hover {
            transform: scale(1.2);
        }
        .selected {
            border: 2px solid #4CAF50;
            border-radius: 50%;
        }
        #result {
            margin-top: 20px;
            font-size: 24px;
        }
        #thank-you {
            display: none;
            margin-top: 20px;
            font-size: 30px;
            color: green;
        }
    </style>
</head>
<body>
    <h1>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã«ãŠç­”ãˆãã ã•ã„</h1>
    <div class="survey-container">
        <span class="emoji" data-value="1">ğŸ˜¡</span>
        <span class="emoji" data-value="2">ğŸ˜Ÿ</span>
        <span class="emoji" data-value="3">ğŸ˜</span>
        <span class="emoji" data-value="4">ğŸ˜Š</span>
        <span class="emoji" data-value="5">ğŸ˜</span>
    </div>
    <div id="result">é¸æŠã—ãŸè©•ä¾¡: ãªã—</div>
    <div id="thank-you">Thank you!</div>

    <script>
        const emojis = document.querySelectorAll('.emoji');
        const result = document.getElementById('result');
        const thankYouMessage = document.getElementById('thank-you');
        let selectedValue = null;
        let counter = 0;  // é€£ç•ªç”¨ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼

        emojis.forEach(emoji => {
            emoji.addEventListener('click', () => {
                // ä»¥å‰ã®é¸æŠã‚’ã‚¯ãƒªã‚¢
                emojis.forEach(e => e.classList.remove('selected'));

                // æ–°ã—ã„é¸æŠã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                emoji.classList.add('selected');
                selectedValue = emoji.getAttribute('data-value');

                // çµæœã‚’è¡¨ç¤º
                result.textContent = `é¸æŠã—ãŸè©•ä¾¡: ${selectedValue}`;

                // ã€ŒThank you!ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€ä¸€å®šæ™‚é–“å¾Œã«åˆæœŸåŒ–
                thankYouMessage.style.display = 'block';
                setTimeout(() => {
                    thankYouMessage.style.display = 'none';
                    resetSurvey();
                }, 2000);

                // é€£ç•ªä»˜ãã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                createAndDownloadFile(selectedValue);
            });
        });

        function resetSurvey() {
            // é¸æŠã‚’ã‚¯ãƒªã‚¢
            emojis.forEach(e => e.classList.remove('selected'));
            result.textContent = 'é¸æŠã—ãŸè©•ä¾¡: ãªã—';
            selectedValue = null;
        }

        function createAndDownloadFile(value) {
            // é€£ç•ªã‚’ç”Ÿæˆ (6æ¡)
            counter++;
            const serialNumber = String(counter).padStart(6, '0');  // 6æ¡ã«0åŸ‹ã‚

            // ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
            const textData = `${value}`;
            const blob = new Blob([textData], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);

            // ãƒ•ã‚¡ã‚¤ãƒ«åã«6æ¡ã®é€£ç•ªã‚’ä»˜åŠ 
            const fileName = `result_${serialNumber}.txt`;

            // è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ãƒªãƒ³ã‚¯ã‚’ä½œæˆ
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;

            // ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            a.click();

            // ãƒªã‚½ãƒ¼ã‚¹ã®è§£æ”¾
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>